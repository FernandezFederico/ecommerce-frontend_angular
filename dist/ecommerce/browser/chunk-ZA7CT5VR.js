import{a as T}from"./chunk-C6EVMWWI.js";import{a as A}from"./chunk-VGCEYYDW.js";import{N,_ as L,b as j,e as q,t as b}from"./chunk-SXOTAUVO.js";import{h as F,l as O}from"./chunk-XHZKNT62.js";import"./chunk-AESYL7IM.js";import{$ as y,Ba as S,Ca as D,Gb as a,Hb as n,Ib as v,Mb as I,Sb as m,Ub as x,Xc as B,Yc as P,bb as R,cc as s,dc as C,dd as k,eb as c,ec as w,fb as u,ha as _,l as E,ra as h,sa as f,ub as g,xb as d}from"./chunk-W6ACBSJJ.js";function z(o,e){if(o&1&&v(0,"app-card",3),o&2){let p=e.$implicit;d("product",p)("redirectRoute","/dashboard/customer-products-list/"+p._id)("showAddButton",!1)}}function J(o,e){o&1&&(a(0,"span"),s(1," No se encontraron productos "),n())}var $=(()=>{let e=class e{constructor(i){this.productsService=i,this.productsList=[],this.destroy$=new E,this.productsService.productQuery$.subscribe(t=>{this.loadProducts(t)})}loadProducts(i){i?this.productsService.searchProducts(i).pipe(y(this.destroy$)).subscribe({next:t=>{this.productsList=t},error:t=>console.error(t)}):this.productsService.getProducts().pipe(y(this.destroy$)).subscribe({next:t=>{this.productsList=t},error:t=>console.error(t)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(t){return new(t||e)(u(b))},e.\u0275cmp=h({type:e,selectors:[["app-customer-products-list"]],decls:3,vars:2,consts:[[1,"customer-products-list__container"],[3,"product","redirectRoute","showAddButton",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"product","redirectRoute","showAddButton"]],template:function(t,r){t&1&&(a(0,"div",0),g(1,z,1,3,"app-card",1)(2,J,2,0,"span",2),n()),t&2&&(c(),d("ngForOf",r.productsList),c(),d("ngIf",r.productsList.length===0))},dependencies:[B,P,N],styles:[".customer-products-list__container[_ngcontent-%COMP%]{min-height:100dvh;display:flex;flex-wrap:wrap;justify-content:center;padding:20px}"]});let o=e;return o})();function K(o,e){if(o&1){let p=I();a(0,"button",10),m("click",function(){S(p);let t=x();return D(t.onAddToCart())}),s(1,"Agregar a Carrito"),n()}}function W(o,e){if(o&1){let p=I();a(0,"button",11),m("click",function(){S(p);let t=x();return D(t.onRemoveFromCart(t.productData._id))}),s(1,"Quitar del Carrito"),n()}}var V=(()=>{let e=class e{constructor(i,t,r,l,U){this.activeRoute=i,this.productsService=t,this.alertService=r,this.cartService=l,this.authService=U,this.quantityOfProducts=1,this.showRemoveCartButton=!1,this.getProductData()}getProductData(){this.activeRoute.paramMap.subscribe({next:i=>{if(this.productId=i.get("id"),this.productId){this.onGetProductById(this.productId);let t=localStorage.getItem("userData");if(t){let r=JSON.parse(t)._id;this.cartService.getCartProductsFromDb(r)}this.cartService.cart$.subscribe(r=>{this.showRemoveCartButton=r.some(l=>l._id===this.productId)})}}})}onGetProductById(i){this.productsService.getProductById(i).subscribe({next:t=>{this.productData=t},error:t=>{this.alertService.showErrorAlert("Error al cargar los datos!")}})}checkProductInCart(i){let t=this.cartService.getCart();this.showRemoveCartButton=t.some(r=>r._id===i)}onHandleQuantity(i){this.quantityOfProducts<10&&i==="plus"?this.quantityOfProducts++:this.quantityOfProducts>1&&i==="min"&&this.quantityOfProducts--}onAddToCart(){if(!this.productData)this.alertService.showErrorAlert("Error al cagar el producto!");else if(this.productData.quantity=this.quantityOfProducts,!localStorage.getItem("userData"))this.cartService.addToCard(this.productData),this.showRemoveCartButton=!0;else{let i=this.authService.authLoginUser;if(i){let t={Product:this.productData,userId:i._id};this.cartService.createCartDataInDb(t).subscribe({next:r=>{this.cartService.getCartProductsFromDb(i._id),this.showRemoveCartButton=!0},error:r=>{this.alertService.showErrorAlert("Error al cargar los datos!")}}),this.showRemoveCartButton=!0}}}onRemoveFromCart(i){localStorage.getItem("userData")?(this.userId=this.authService.authLoginUser?._id,this.userId&&this.productId&&this.cartService.removeProductFromCart(this.userId,this.productId).subscribe({next:t=>{this.cartService.getCartProductsFromDb(this.userId)},error:t=>{this.alertService.showErrorAlert("Error al cargar los datos!")}})):this.productData&&this.cartService.removeFromLocalCart(this.productData),this.showRemoveCartButton=!1}};e.\u0275fac=function(t){return new(t||e)(u(F),u(b),u(j),u(T),u(A))},e.\u0275cmp=h({type:e,selectors:[["app-product-detail"]],decls:25,vars:10,consts:[[1,"product-detail__container"],[1,"image__container"],["alt","product image",1,"product-detail__image",3,"src"],[1,"data__container"],[1,"product-detail__info"],[1,"product-detail__quantity"],["mat-raised-button","",3,"click","disabled"],["class","product-detail__button-add","mat-raised-button","",3,"click",4,"ngIf"],["class","product-detail__button-remove","mat-raised-button","","color","warn",3,"click",4,"ngIf"],[1,"product-detail__description"],["mat-raised-button","",1,"product-detail__button-add",3,"click"],["mat-raised-button","","color","warn",1,"product-detail__button-remove",3,"click"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"section",1),v(2,"img",2),n(),a(3,"section",3)(4,"div",4)(5,"h3"),s(6),n(),a(7,"span"),s(8),n(),a(9,"span"),s(10),n(),a(11,"div",5)(12,"button",6),m("click",function(){return r.onHandleQuantity("min")}),s(13,"-"),n(),a(14,"span"),s(15),n(),a(16,"button",6),m("click",function(){return r.onHandleQuantity("plus")}),s(17,"+"),n()(),g(18,K,2,0,"button",7)(19,W,2,0,"button",8),n(),a(20,"div",9)(21,"h4"),s(22,"Descripci\xF3n:"),n(),a(23,"p"),s(24),n()()()()),t&2&&(c(2),d("src","http://localhost:8000"+(r.productData==null?null:r.productData.productImage),R),c(4),C(r.productData==null?null:r.productData.productName),c(2),w("ID#: ",r.productData==null?null:r.productData._id,""),c(2),w("$ ",r.productData==null?null:r.productData.productPrice,""),c(2),d("disabled",r.showRemoveCartButton),c(3),C(r.quantityOfProducts),c(),d("disabled",r.showRemoveCartButton),c(2),d("ngIf",!r.showRemoveCartButton),c(),d("ngIf",r.showRemoveCartButton),c(5),C(r.productData==null?null:r.productData.productDescription))},dependencies:[P,q],styles:[".product-detail__container[_ngcontent-%COMP%]{display:grid;height:100%;margin:30px 0;grid-template-columns:1fr .5fr;gap:10px;padding:0 150px}.product-detail__container[_ngcontent-%COMP%]   .image__container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.product-detail__container[_ngcontent-%COMP%]   .image__container[_ngcontent-%COMP%]   .product-detail__image[_ngcontent-%COMP%]{height:700px;width:auto}.product-detail__container[_ngcontent-%COMP%]   .data__container[_ngcontent-%COMP%]{height:fit-content;border:solid .5px grey;display:flex;flex-direction:column;padding:20px}.product-detail__container[_ngcontent-%COMP%]   .data__container[_ngcontent-%COMP%]   .product-detail__info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.product-detail__container[_ngcontent-%COMP%]   .data__container[_ngcontent-%COMP%]   .product-detail__button-add[_ngcontent-%COMP%]{background-color:#000;color:#fff;max-width:200px;border-radius:0}.product-detail__container[_ngcontent-%COMP%]   .data__container[_ngcontent-%COMP%]   .product-detail__button-remove[_ngcontent-%COMP%]{max-width:200px;border-radius:0}.product-detail__container[_ngcontent-%COMP%]   .data__container[_ngcontent-%COMP%]   .product-detail__quantity[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.product-detail__container[_ngcontent-%COMP%]   .data__container[_ngcontent-%COMP%]   .product-detail__quantity[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:center;width:30px}"]});let o=e;return o})();var X=[{path:"",component:$},{path:":id",component:V}],Q=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f({type:e}),e.\u0275inj=_({imports:[O.forChild(X),O]});let o=e;return o})();var vt=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f({type:e}),e.\u0275inj=_({imports:[k,Q,L]});let o=e;return o})();export{vt as CustomerProductsListModule};
